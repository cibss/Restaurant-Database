CREATE TABLE MEJA
	(
		no_meja  CHAR(2) NOT NULL,
		jumlah_kursi VARCHAR2(2)
	);
ALTER TABLE MEJA ADD CONSTRAINT Meja_PK PRIMARY KEY (no_meja);

CREATE TABLE BUKU_MENU
	(
		id_menu CHAR(3) NOT NULL,
		nama_menu VARCHAR2(30),
		harga NUMBER
	);
ALTER TABLE BUKU_MENU ADD CONSTRAINT Buku_Menu_PK PRIMARY KEY (id_menu);

CREATE TABLE PELANGGAN
	(
		id_pelanggan CHAR(9) NOT NULL,
		nama_pelanggan VARCHAR2(30) 
	);
ALTER TABLE PELANGGAN ADD CONSTRAINT Pelanggan_PK PRIMARY KEY (id_pelanggan);

CREATE TABLE PELAYAN
	(
		id_pelayan CHAR(4) NOT NULL,
		nama_pelayan VARCHAR2(30)
	);
ALTER TABLE PELAYAN ADD CONSTRAINT Pelayan_PK PRIMARY KEY (id_pelayan);

CREATE TABLE MANAJER
	(
		id_manajer CHAR(4) NOT NULL,
		nama_manajer VARCHAR2(30)
	);
ALTER TABLE MANAJER ADD CONSTRAINT Manajer_PK PRIMARY KEY (id_manajer);

CREATE TABLE KASIR
	(
		id_kasir CHAR(3) NOT NULL,
		nama_kasir VARCHAR2(30)
	);
ALTER TABLE KASIR ADD CONSTRAINT Kasir_PK PRIMARY KEY (id_kasir);

CREATE TABLE MEMESAN
    (
        id_pesan CHAR(4) NOT NULL,
        id_menu CHAR(3) NOT NULL,
        no_meja CHAR(2) NOT NULL,
        tanggal DATE,
        jam VARCHAR2(5),
        porsi VARCHAR2(2)
    );
ALTER TABLE MEMESAN ADD CONSTRAINT Memesan_PK PRIMARY KEY(id_pesan);

CREATE TABLE MEMILIH 
    (
        id_pilih CHAR(4) NOT NULL,
        id_pelanggan CHAR(9) NOT NULL,
        id_pesan CHAR(4) NOT NULL,
        jumlah_meja VARCHAR2(2)
    );
ALTER TABLE MEMILIH ADD CONSTRAINT Memilih_PK PRIMARY KEY(id_pilih);

CREATE TABLE PELANGGAN_NON_MEMBER
    (
        id_pelanggan CHAR(9) NOT NULL,
        kupon VARCHAR2(3) 
    );
ALTER TABLE PELANGGAN_NON_MEMBER ADD CONSTRAINT Pelanggan_Non_Member_PK PRIMARY KEY(id_pelanggan);

CREATE TABLE PELANGGAN_MEMBER
    (
        id_pelanggan CHAR(9) NOT NULL,
        diskon VARCHAR2(3)
    );
ALTER TABLE PELANGGAN_MEMBER ADD CONSTRAINT Pelanggan_Member_PK PRIMARY KEY(id_pelanggan);

CREATE TABLE MELAYANI
    (
        id_melayani CHAR(4) NOT NULL,
        id_pelayan CHAR(4) NOT NULL,
        id_pelanggan CHAR(9) NOT NULL,
        pesanan VARCHAR2(30)
    );
ALTER TABLE MELAYANI ADD CONSTRAINT Melayani_PK PRIMARY KEY(id_melayani);


CREATE TABLE MENGELOLA
    (
        id_manajer CHAR(4) NOT NULL,
        id_kasir CHAR(3) NOT NULL,
        id_pelayan CHAR(4) NOT NULL
    );
ALTER TABLE MENGELOLA ADD CONSTRAINT Mengelola_Manajer_PK PRIMARY KEY (id_manajer, id_kasir, id_pelayan);

    
CREATE TABLE DETIL_TRANSAKSI
    (
        id_transaksi CHAR(6) NOT NULL,
        id_pelanggan CHAR(9) NOT NULL,
        nama_menu VARCHAR2(30)
    );

CREATE TABLE TRANSAKSI
    (
        id_transaksi CHAR(6) NOT NULL,
        id_kasir CHAR(3) NOT NULL,
        tgl_transaksi DATE,
        total_transaksi NUMBER
    );
ALTER TABLE TRANSAKSI ADD CONSTRAINT Transaksi_PK PRIMARY KEY (id_transaksi);


ALTER TABLE Memesan ADD CONSTRAINT Memesan_Buku_Menu_FK FOREIGN KEY (id_menu) REFERENCES Buku_Menu (id_menu);
ALTER TABLE Memesan ADD CONSTRAINT Memesan_Meja_FK FOREIGN KEY (no_meja) REFERENCES Meja (no_meja);

ALTER TABLE Memilih ADD CONSTRAINT Memilih_Pelanggan_FK FOREIGN KEY (id_pelanggan) REFERENCES Pelanggan (id_pelanggan);
ALTER TABLE Memilih ADD CONSTRAINT Memilih_Memesan_FK FOREIGN KEY (id_pesan) REFERENCES Memesan (id_pesan);

ALTER TABLE Pelanggan_Non_Member ADD CONSTRAINT Pelanggan_Non_Member_FK FOREIGN KEY (id_pelanggan) REFERENCES Pelanggan (id_pelanggan);
ALTER TABLE Pelanggan_Member ADD CONSTRAINT Pelanggan_Member_Pelanggan_FK FOREIGN KEY (id_pelanggan) REFERENCES Pelanggan (id_pelanggan);

ALTER TABLE Melayani ADD CONSTRAINT Melayani_Pelayan_FK FOREIGN KEY (id_pelayan) REFERENCES Pelayan (id_pelayan);
ALTER TABLE Melayani ADD CONSTRAINT Melayani_Pelanggan_FK FOREIGN KEY (id_pelanggan) REFERENCES Pelanggan (id_pelanggan);

ALTER TABLE Mengelola ADD CONSTRAINT Mengelola_Manajer_FK FOREIGN KEY (id_manajer) REFERENCES Manajer (id_manajer);
ALTER TABLE Mengelola ADD CONSTRAINT Mengelola_Kasir_FK FOREIGN KEY (id_kasir) REFERENCES Kasir (id_kasir);
ALTER TABLE Mengelola ADD CONSTRAINT Mengelola_Pelayan_FK FOREIGN KEY (id_pelayan) REFERENCES Pelayan (id_pelayan);

ALTER TABLE Detil_Transaksi ADD CONSTRAINT Detil_Transaksi_Transaksi_FK FOREIGN KEY (id_transaksi) REFERENCES Transaksi(id_transaksi);
ALTER TABLE Detil_Transaksi ADD CONSTRAINT Detil_Transaksi_Pelanggan_FK FOREIGN KEY (id_pelanggan) REFERENCES Pelanggan(id_pelanggan);
ALTER TABLE Transaksi ADD CONSTRAINT Transaksi_Kasir_FK FOREIGN KEY (id_kasir) REFERENCES Kasir(id_kasir);

ALTER SESSION SET NLS_DATE_FORMAT = 'dd/mon/yyyy';

INSERT INTO MEJA VALUES('01','2');
INSERT INTO MEJA VALUES('02','2');
INSERT INTO MEJA VALUES('03','2');
INSERT INTO MEJA VALUES('04','2');
INSERT INTO MEJA VALUES('05','2');
INSERT INTO MEJA VALUES('06','4');
INSERT INTO MEJA VALUES('07','4');
INSERT INTO MEJA VALUES('08','4');
INSERT INTO MEJA VALUES('09','4');
INSERT INTO MEJA VALUES('10','4');
INSERT INTO MEJA VALUES('11','6');
INSERT INTO MEJA VALUES('12','6');
INSERT INTO MEJA VALUES('13','6');
INSERT INTO MEJA VALUES('14','6');
INSERT INTO MEJA VALUES('15','6');
INSERT INTO MEJA VALUES('16','8');
INSERT INTO MEJA VALUES('17','8');
INSERT INTO MEJA VALUES('18','8');
INSERT INTO MEJA VALUES('19','8');
INSERT INTO MEJA VALUES('20','8');


INSERT INTO BUKU_MENU VALUES('M01','Nasi Goreng','25000');
INSERT INTO BUKU_MENU VALUES('M02','Mie Goreng','25000');
INSERT INTO BUKU_MENU VALUES('M03','Soto Bandung','20000');
INSERT INTO BUKU_MENU VALUES('M04','Iga Bakar','45000');
INSERT INTO BUKU_MENU VALUES('M05','Sate Ayam','30000');
INSERT INTO BUKU_MENU VALUES('M06','Sate Sapi','40000');
INSERT INTO BUKU_MENU VALUES('M07','Ayam Bakar','15000');
INSERT INTO BUKU_MENU VALUES('M08','Ayam Goreng','10000');
INSERT INTO BUKU_MENU VALUES('M09','Gado-Gado','20000');
INSERT INTO BUKU_MENU VALUES('M10','Mie Ayam','20000');
INSERT INTO BUKU_MENU VALUES('M11','Ice Tea','10000');
INSERT INTO BUKU_MENU VALUES('M12','Ice Lemon Tea','10000');
INSERT INTO BUKU_MENU VALUES('M13','Jus Jeruk','15000');
INSERT INTO BUKU_MENU VALUES('M14','Jus Stroberi','15000');
INSERT INTO BUKU_MENU VALUES('M15','Es Kelapa Muda','15000');
INSERT INTO BUKU_MENU VALUES('M16','Es Kelapa Muda Jeruk','15000');
INSERT INTO BUKU_MENU VALUES('M17','Air Mineral','5000');
INSERT INTO BUKU_MENU VALUES('M18','Sprite','10000');
INSERT INTO BUKU_MENU VALUES('M19','Coca Cola','10000');
INSERT INTO BUKU_MENU VALUES('M20','Fanta','10000');


INSERT INTO MEMESAN VALUES('PS01','M05','05','20/OCT/2017','16.00','2');
INSERT INTO MEMESAN VALUES('PS02','M04','06','20/OCT/2017','16.00','3');
INSERT INTO MEMESAN VALUES('PS03','M06','01','20/OCT/2017','16.12','2');
INSERT INTO MEMESAN VALUES('PS04','M12','02','20/OCT/2017','16.45','1');
INSERT INTO MEMESAN VALUES('PS05','M15','03','20/OCT/2017','16.48','1');
INSERT INTO MEMESAN VALUES('PS06','M20','10','20/OCT/2017','16.55','2');
INSERT INTO MEMESAN VALUES('PS07','M01','10','20/OCT/2017','17.00','2');
INSERT INTO MEMESAN VALUES('PS08','M03','04','20/OCT/2017','17.30','3');
INSERT INTO MEMESAN VALUES('PS09','M20','06','20/OCT/2017','17.30','4');
INSERT INTO MEMESAN VALUES('PS10','M02','03','20/OCT/2017','17.35','2');


INSERT INTO PELANGGAN VALUES('MM2017001','Kevin');
INSERT INTO PELANGGAN VALUES('MM2017002','Wildan');
INSERT INTO PELANGGAN VALUES('MM2017003','Chandra');
INSERT INTO PELANGGAN VALUES('MM2017004','Andriawan');
INSERT INTO PELANGGAN VALUES('MM2017005','Juno');
INSERT INTO PELANGGAN VALUES('MM2017006','Eva');
INSERT INTO PELANGGAN VALUES('MM2017007','Diah');
INSERT INTO PELANGGAN VALUES('MM2017008','Mutiara');
INSERT INTO PELANGGAN VALUES('MM2017009','Annisa');
INSERT INTO PELANGGAN VALUES('MM2017010','Anna');
INSERT INTO PELANGGAN VALUES('NM2017001','Fitra');
INSERT INTO PELANGGAN VALUES('NM2017002','Pratama');
INSERT INTO PELANGGAN VALUES('NM2017003','Reynaldi');
INSERT INTO PELANGGAN VALUES('NM2017004','Rico');
INSERT INTO PELANGGAN VALUES('NM2017005','Fariz');
INSERT INTO PELANGGAN VALUES('NM2017006','Suci');
INSERT INTO PELANGGAN VALUES('NM2017007','Monika');
INSERT INTO PELANGGAN VALUES('NM2017008','Desi');
INSERT INTO PELANGGAN VALUES('NM2017009','Tari');
INSERT INTO PELANGGAN VALUES('NM2017010','Siti');

INSERT INTO PELANGGAN_MEMBER VALUES('MM2017001','15%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017002','15%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017003','10%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017004','20%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017005','10%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017006','10%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017007','15%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017008','20%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017009','20%');
INSERT INTO PELANGGAN_MEMBER VALUES('MM2017010','10%');

INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017001','5');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017002','3');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017003','8');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017004','1');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017005','6');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017006','2');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017007','9');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('NM2017008','10');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('MM2017009','11');
INSERT INTO PELANGGAN_NON_MEMBER VALUES('MM2017010','14');

INSERT INTO MEMILIH VALUES('PL01','MM2017007','PS01','1');
INSERT INTO MEMILIH VALUES('PL02','NM2017006','PS02','1');
INSERT INTO MEMILIH VALUES('PL03','NM2017002','PS03','1');
INSERT INTO MEMILIH VALUES('PL04','MM2017005','PS04','1');
INSERT INTO MEMILIH VALUES('PL05','MM2017001','PS05','1');
INSERT INTO MEMILIH VALUES('PL06','NM2017008','PS06','1');
INSERT INTO MEMILIH VALUES('PL07','NM2017008','PS07','1');
INSERT INTO MEMILIH VALUES('PL08','NM2017010','PS08','1');
INSERT INTO MEMILIH VALUES('PL09','NM2017006','PS09','1');
INSERT INTO MEMILIH VALUES('PL10','MM2017001','PS10','1');


INSERT INTO TRANSAKSI VALUES ('TRX001','K03','20/OCT/2017','60000');
INSERT INTO TRANSAKSI VALUES ('TRX002','K03','20/OCT/2017','135000');
INSERT INTO TRANSAKSI VALUES ('TRX003','K03','20/OCT/2017','80000');
INSERT INTO TRANSAKSI VALUES ('TRX004','K03','20/OCT/2017','10000');
INSERT INTO TRANSAKSI VALUES ('TRX005','K03','20/OCT/2017','15000');
INSERT INTO TRANSAKSI VALUES ('TRX006','K10','20/OCT/2017','20000');
INSERT INTO TRANSAKSI VALUES ('TRX007','K10','20/OCT/2017','50000');
INSERT INTO TRANSAKSI VALUES ('TRX008','K10','20/OCT/2017','60000');
INSERT INTO TRANSAKSI VALUES ('TRX009','K10','20/OCT/2017','40000');
INSERT INTO TRANSAKSI VALUES ('TRX010','K10','20/OCT/2017','50000');


INSERT INTO KASIR VALUES ('K01','Willy');
INSERT INTO KASIR VALUES ('K02','Paul');
INSERT INTO KASIR VALUES ('K03','Ekhsan');
INSERT INTO KASIR VALUES ('K04','Lala');
INSERT INTO KASIR VALUES ('K05','Yin Ma');
INSERT INTO KASIR VALUES ('K06','Shuree');
INSERT INTO KASIR VALUES ('K07','Banyu');
INSERT INTO KASIR VALUES ('K08','Sudana');
INSERT INTO KASIR VALUES ('K09','Sahimah');
INSERT INTO KASIR VALUES ('K10','Shinta');
INSERT INTO KASIR VALUES ('K11','Bob');
INSERT INTO KASIR VALUES ('K12','Tito');
INSERT INTO KASIR VALUES ('K13','Augustus');
INSERT INTO KASIR VALUES ('K14','Kalika');
INSERT INTO KASIR VALUES ('K15','Isma');
INSERT INTO KASIR VALUES ('K16','Gama');
INSERT INTO KASIR VALUES ('K17','Sandi');
INSERT INTO KASIR VALUES ('K18','Hartono');
INSERT INTO KASIR VALUES ('K19','Dio');
INSERT INTO KASIR VALUES ('K20','Rinto');


INSERT INTO DETIL_TRANSAKSI VALUES ('TRX001','MM2017007','Sate Ayam');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX002','NM2017006','Iga Bakar');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX003','NM2017002','Sate Sapi');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX004','MM2017005','Ice Lemon Tea');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX005','MM2017001','Es Kelapa Muda');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX006','NM2017008','Fanta');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX007','NM2017008','Nasi Goreng');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX008','NM2017010','Soto Bandung');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX009','NM2017006','Fanta');
INSERT INTO DETIL_TRANSAKSI VALUES ('TRX010','MM2017001','Mie Goreng');


INSERT INTO MANAJER VALUES ('MJ01','Krystal');
INSERT INTO MANAJER VALUES ('MJ02','Siberius');
INSERT INTO MANAJER VALUES ('MJ03','Ilhamsyah');
INSERT INTO MANAJER VALUES ('MJ04','Kuswardani');
INSERT INTO MANAJER VALUES ('MJ05','Pradanata');
INSERT INTO MANAJER VALUES ('MJ06','Vyonita');
INSERT INTO MANAJER VALUES ('MJ07','Kusuma');
INSERT INTO MANAJER VALUES ('MJ08','Rhea');
INSERT INTO MANAJER VALUES ('MJ09','Suwarman');
INSERT INTO MANAJER VALUES ('MJ10','Chira');
INSERT INTO MANAJER VALUES ('MJ11','Paharapan');
INSERT INTO MANAJER VALUES ('MJ12','Inggrid');
INSERT INTO MANAJER VALUES ('MJ13','Sigid');
INSERT INTO MANAJER VALUES ('MJ14','Fillia');
INSERT INTO MANAJER VALUES ('MJ15','Maxus');
INSERT INTO MANAJER VALUES ('MJ16','Aminah');
INSERT INTO MANAJER VALUES ('MJ17','Putu');
INSERT INTO MANAJER VALUES ('MJ18','Amaliyah');
INSERT INTO MANAJER VALUES ('MJ19','Jajang');
INSERT INTO MANAJER VALUES ('MJ20','Lheno');


INSERT INTO MENGELOLA VALUES ('MJ01','K03','PY06');
INSERT INTO MENGELOLA VALUES ('MJ01','K03','PY13');
INSERT INTO MENGELOLA VALUES ('MJ01','K03','PY16');
INSERT INTO MENGELOLA VALUES ('MJ01','K03','PY19');
INSERT INTO MENGELOLA VALUES ('MJ20','K10','PY03');
INSERT INTO MENGELOLA VALUES ('MJ20','K10','PY08');
INSERT INTO MENGELOLA VALUES ('MJ20','K10','PY10');
INSERT INTO MENGELOLA VALUES ('MJ20','K10','PY17');
INSERT INTO MENGELOLA VALUES ('MJ06','K19','PY01');
INSERT INTO MENGELOLA VALUES ('MJ06','K19','PY04');
INSERT INTO MENGELOLA VALUES ('MJ06','K19','PY12');
INSERT INTO MENGELOLA VALUES ('MJ06','K19','PY11');


INSERT INTO PELAYAN VALUES('PY01','Rita');
INSERT INTO PELAYAN VALUES('PY02','Jack');
INSERT INTO PELAYAN VALUES('PY03','Harumi');
INSERT INTO PELAYAN VALUES('PY04','Oktavian');
INSERT INTO PELAYAN VALUES('PY05','Junita');
INSERT INTO PELAYAN VALUES('PY06','Marsell');
INSERT INTO PELAYAN VALUES('PY07','Maria');
INSERT INTO PELAYAN VALUES('PY08','Febriyani');
INSERT INTO PELAYAN VALUES('PY09','Mai');
INSERT INTO PELAYAN VALUES('PY10','Hani');
INSERT INTO PELAYAN VALUES('PY11','Julio');
INSERT INTO PELAYAN VALUES('PY12','Gisha');
INSERT INTO PELAYAN VALUES('PY13','Septiani');
INSERT INTO PELAYAN VALUES('PY14','Suratman');
INSERT INTO PELAYAN VALUES('PY15','Shella');
INSERT INTO PELAYAN VALUES('PY16','Judith');
INSERT INTO PELAYAN VALUES('PY17','Luna');
INSERT INTO PELAYAN VALUES('PY18','Franky');
INSERT INTO PELAYAN VALUES('PY19','Audy');
INSERT INTO PELAYAN VALUES('PY20','Amy');

INSERT INTO MELAYANI VALUES ('MY01','PY06','MM2017007','Sate Ayam','2');
INSERT INTO MELAYANI VALUES ('MY02','PY13','MM2017006','Iga Bakar','3');
INSERT INTO MELAYANI VALUES ('MY03','PY06','MM2017002','Sate Sapi','2');
INSERT INTO MELAYANI VALUES ('MY04','PY16','MM2017005','Ice Lemon Tea','1');
INSERT INTO MELAYANI VALUES ('MY05','PY19','MM2017001','Es Kelapa Muda','1');
INSERT INTO MELAYANI VALUES ('MY06','PY10','MM2017008','Fanta','2');
INSERT INTO MELAYANI VALUES ('MY07','PY03','MM2017008','Nasi Goreng','2');
INSERT INTO MELAYANI VALUES ('MY08','PY17','MM2017010','Soto Bandung','3');
INSERT INTO MELAYANI VALUES ('MY09','PY08','MM2017006','Fanta','4');
INSERT INTO MELAYANI VALUES ('MY10','PY03','MM2017001','Mie Goreng','2');


SELECT id_transaksi, total_transaksi FROM transaksi
WHERE id_kasir = 'K03';

SELECT SUM(total_transaksi) AS Total FROM transaksi;

SELECT id_pelanggan, nama_pelanggan, buku_menu.nama_menu FROM pelanggan
JOIN memilih USING(id_pelanggan) 
JOIN memesan USING(id_pesan)
JOIN buku_menu USING(id_menu);

SELECT nama_pelayan, pelanggan.nama_pelanggan, melayani.pesanan FROM pelayan
INNER JOIN melayani ON pelayan.id_pelayan = melayani.id_pelayan
INNER JOIN pelanggan ON melayani.id_pelanggan = pelanggan.id_pelanggan;

SELECT kasir.nama_kasir, COUNT(transaksi.id_transaksi) AS jumlah_transaksi FROM kasir
INNER JOIN transaksi ON kasir.id_kasir = transaksi.id_kasir
GROUP BY kasir.nama_kasir;


SELECT kasir.nama_kasir, COUNT(transaksi.id_transaksi) AS jumlah_transaksi FROM kasir
INNER JOIN transaksi ON kasir.id_kasir = transaksi.id_kasir
WHERE id_transaksi = (SELECT MAX(transaksi.id_transaksi) FROM transaksi)
GROUP BY kasir.nama_kasir;














